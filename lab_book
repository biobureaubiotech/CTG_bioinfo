April 17th, 2017

Today I've done the BLAST of all 60717 L. fortunei proteins predicted in the genome against A. gambiae proteins related to fertility publishe
in a Nature Biotechnology paper (Hammond et al., 2016 doi:10.1038/nbt.3439 ) 

Database was all the protein sequences present at Supplementary Table 5 of the above paper, although 4 sequences listed on Table 5 was not
present on the genome of A. gambiae downloaded from the Esembl browser, nor were find went specificaly searched on the Esembl website.
Those not found sequences are: AGAP011235-PA, AGAP010915-PA, AGAP007997-PA, AGAP012170-PA.

First local BLAST results are at biobureau gdrive: https://drive.google.com/drive/u/1/folders/0B2pYU5fjrq3EczhILWRyWDBTa3M 



April 24th, 2017.

Organizing all the BLASTs to find the fertility genes in L. fortunei. We are using the genes employed by Crisanti 

blastp -query Anopheles_gambiae.AgamP4.pep.crisanti.fasta -db /home/ubuntu/nr -evalue 1e-05 -num_threads 4 -out Anopheles_gambiae.AgamP4.pep.crisanti.fasta.blast-NR.1e05 &


1-) Another BLAST from today: L. fortunei proteins against molluscan reproduction genes Ju_Americo have choosen.

makeblastdb -in mollusca.rep.fa -dbtype prot
blastp -query marcela.fasta -db molluscan_genes/mollusca.rep.fa -evalue 1e-05 -num_threads 4 -out marcela.mollusca.rep.fa1e05 &

April, 25th 2017

-BLASTing all reproduction mollucans mRNA and proteins against marcela.fasta
I'm doing this in Amazon, in the isntance called CTG_BLAST 
 blastp -query marcela.fasta -db molluscan_genes/mollusca.rep.fa -evalue 1e-05 -num_threads 4 -out marcela.mollusca.rep.fa1e05 &
 


-BLASTing L. fortunei VASA protein JuAmerico found with the transcripts assembled from Trinity. Just to check. The protein is well conserved
but it looks like its missing 100aa at the beginning.

/data2/Marcela/scripts/ncbi-blast-2.4.0+/bin/tblastn -query vasa.lf.fa -db /data2/Marcela/data/rna-seq/trinti.1.2.3/Trinities.1.2.3.fasta -evalue 1e-05 -num_threads 4 -out vasa.trinity1.2.3.tblastn &
After that, I got all the trinity hits and translated them using transdecode, so we can check how similar to the genomic de novo preditec vasa the transcripts are:

perl /home/bioma/scripts/PASApipeline-2.0.2/pasa-plugins/transdecoder/transcripts_to_best_scoring_ORFs.pl -t vasa.trinity1.2.3.tblastn.cov.trinityID.fasta

-BLASTing L. fortunei (marcela.fasta) against C. elegans proteins selected by Ju (3979 seqs, sterile-phenoype).
makeblastdb -in c_elegans.PRJNA13758.WS258.protein.sterile.fa -dbtype prot

nohup blastp -query ../marcela.fasta -db /home/ubuntu/c_elegans/c_elegans.PRJNA13758.WS258.protein.sterile.fa -evalue 1e-05 -num_threads 4 -out marcela.c_elegans.PRJNA13758.WS258.protein.sterile.1e05 &


26 April, 2017

How to get a whole line by a list of IDs.

awk 'NR==FNR{tgts[$1]; next} $1 in tgts' file1 file2


April 27th, 2017.

Today I'll curate the possible VASA gene Ju found among the golden Mussel proteins. Which means I'll look into the scaffolds from 
where it was predicted, and see how much RNA-seq there is aligned to it.

So the first thing is to find which scaffold it is. And it is this:

L_FORTUNEI.itr6_4515

Then, you get all the rna-seq aligned to it in a bam file using samtools

samtools view -h all.merged.sorted.bam L_FORTUNEI.itr6_4515_ > L_FORTUNEI.itr6_4515_all.merged.sam

then
samtools view -Sb L_FORTUNEI.itr6_4515_all.merged.sam -o L_FORTUNEI.itr6_4515_all.merged.bam
samtools sort
samtools index

then
Get the fasta for the scaffold
and
Get the gff for the scaffold

/data2/Marcela/scripts/Python-3.5.2/python /data2/Marcela/scripts/biocode/gff/filter_gff3_by_id_list.py -i /data2/Marcela/pasa.itr6/marcelAAAa_pasa.gene_structures_post_PASA_updates.85229.gff3 -o id.bla.gff3 -l /data2/Marcela/hisat2/id.bla

Then sort, zip and tabix the gff

sort -k1,1 -k4,4n -rk3,3n id.bla.gff3 > id.bla.sorted.gff
bgzip id.bla.sorted.gff
tabix -p gff id.bla.sorted.gff.gz

May, 4th (be with you!) 2017.

Finding best reciprocal BLAST hit!

I found this script and I'm using it: https://github.com/peterjc/galaxy_blast/blob/master/tools/blast_rbh/blast_rbh.py

The first I did was to use the BLAST matches ju found between LF and C_elegans (Celegans_Agambiae_Hits_evalue50_ID60.xlsx).
The fasta files are at local machine:
/home/bioma/2017_marcela/CTG/lf.blas.celegans.interest.fasta
/home/bioma/2017_marcela/CTG/c_elegens.interested.fasta
I've modified same names in the c_elegans file because there are more than 1 protein per locus, so they have the same inicial name
the file is called c_elegens.interested.id.modified.forRBBH (on gdocs)
Then I run the program localy:
bioma@bioma-XPS-8300:~/2017_marcela/CTG$ python ../../scripts/filterfasta.py -i lf.blas.celegans.interest.id ../mexilhao_tese_preeprint/marcela.fasta > lf.blas.celegans.interest.fasta
bioma@bioma-XPS-8300:~/2017_marcela/CTG$ python ../../scripts/rbbh.py -a prot -t blastp -o output.tsv lf.blas.celegans.interest.fasta c_elegens.interested.fasta
Result:
Done, 19 RBH found
Warning: Sequences with tied best hits found, you may have duplicates/clusters

Result file called: lf.ce-elegans.RBBH (on gdocs)

- RBBH analysis with molluscan proteins. Only vasa protein got that for now

python ../../scripts/filterfasta.py -i molluscan.reproduction.LF.blastp.lf.id ../mexilhao_tese_preeprint/marcela.fasta > molluscan.reproduction.LF.blastp.lf.fasta
less molluscan.reproduction.LF.blastp.lf.fasta
python ../../scripts/rbbh.py -h
python ../../scripts/rbbh.py -a prot -t blastp -o lf.molluscan-reproduction.RBBH --threads=4 molluscan.reproduction.LF.blastp.lf.fasta sequence-proteins-JU.fasta
ls -ltr
less lf.molluscan-reproduction.RBBH

10th May of 2017.
- Already asked for a quotation to resequence a male and a female golden mussel (genone).
- Today I'm looking into which proteins and scaffolds the trinity (vasa) transcripts TR79527-c2__g1__i3 len=3794, TR76527-c0_g1_i2 len=3728, TR76527-c0_g1_i5 len=3477 
represent.

So, First I've blasted them against marcela.fasta
blastx -query trinity.vasas.fasta -db /data2/Marcela/marcela.fasta.an/marcela.fasta -evalue 1e-05 -out trinity-vasas_marcela.fasta.blastx1e05
Best hits:
TR79527-c2__g1__i3      itr6_4515_pi.g108.t1    100.00  562     0       0       1111    2796    17      578     0.0     1127    44.44   91.68
TR76527-c0_g1_i2        itr6_4515_pi.g108.t1.1.57f69240 100.00  537     0       0       1120    2730    17      553     0.0     1075    43.21   91.33
TR76527-c0_g1_i5        itr6_4515_pi.g108.t1.1.57f69240 100.00  537     0       0       869     2479    17      553     0.0     1075    46.33   91.33

All "good" hits:
TR79527-c2__g1__i3      itr6_4515_pi.g108.t1    100.00  562     0       0       1111    2796    17      578     0.0     1127    14.81   91.68
TR79527-c2__g1__i3      itr6_4515_pi.g108.t1.1.57f69240 99.46   552     3       0       1141    2796    2       553     0.0     1099    14.47   93.37
TR79527-c2__g1__i3      itr6_4515_pi.g108.t1.2.57f69240 99.43   527     3       0       1216    2796    2       528     0.0     1045    13.81   93.07
TR79527-c2__g1__i3      itr6_4515_pi.g108.t1.3.57f69240 99.81   518     1       0       1111    2664    17      534     0.0     1031    13.63   92.99
TR76527-c0_g1_i2        itr6_4515_pi.g108.t1.1.57f69240 100.00  537     0       0       1120    2730    17      553     0.0     1075    14.40   91.33
TR76527-c0_g1_i2        itr6_4515_pi.g108.t1    100.00  537     0       0       1120    2730    42      578     0.0     1075    14.40   87.60
TR76527-c0_g1_i2        itr6_4515_pi.g108.t1.2.57f69240 99.43   527     3       0       1150    2730    2       528     0.0     1046    14.06   93.07
TR76527-c0_g1_i2        itr6_4515_pi.g108.t1.3.57f69240 99.80   493     1       0       1120    2598    42      534     0.0     979     13.20   88.49
TR76527-c0_g1_i5        itr6_4515_pi.g108.t1.1.57f69240 100.00  537     0       0       869     2479    17      553     0.0     1075    15.44   91.33
TR76527-c0_g1_i5        itr6_4515_pi.g108.t1    100.00  537     0       0       869     2479    42      578     0.0     1075    15.44   87.60
TR76527-c0_g1_i5        itr6_4515_pi.g108.t1.2.57f69240 99.43   527     3       0       899     2479    2       528     0.0     1046    15.07   93.07
TR76527-c0_g1_i5        itr6_4515_pi.g108.t1.3.57f69240 99.80   493     1       0       869     2347    42      534     0.0     979     14.15   88.49

- Ok, so I got these three transcripts from above and got the results from them from transdecoder. I then alligned these transdecoder
protein sequences + vasa from uniprot for mytilus and c. gigas + the 3 vasa proteins predicted in the genome. The alligment shows
that is possible the genome-predicted proteins are incomplete, but that the transdecoder has the beginning of them. Now I'll
investigate the gff and the scaffold where they are coded.
Aligment result in the local computer:
/home/bioma/2017_marcela/CTG/transdecoderlong.genome.mitgigas.vasas.aln


